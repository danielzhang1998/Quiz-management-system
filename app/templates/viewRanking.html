{% extends "base.html" %}
{% import "bootstrap/wtf.html" as wtf %}


{% block head %}
{{ super() }}
<!---refers to a css that contains styling for register page
<link rel="stylesheet" href="style.css">
-->
<link rel="stylesheet" href="{{ url_for('static', filename='style.css', _external=True) }}">

{% endblock %}

{% block title %}
Start Quiz Edit
{% endblock %}

{% block body %}
{% block content %}

<div class = "rank">

    <br>
    {% for key in unique_quizsets %}
    <h1>The quiz you have taken is : <span class = "common">"{{ QuizSet.query.filter_by(id=key).first().title }}"</span></h1>
    <br>
    <h3>Quiz ID: <span class = "common">{{ QuizSet.query.filter_by(id=key).first().quiz_id }}</span></h3>
    <h3>Teacher: <span class = "common">{{ User.query.filter_by(id=QuizSet.query.filter_by(id=key).first().author_id).first().name }}</span></h3>


    <!--get a list of marks under current student, current quizset-->
    {% for answers in Answer.query.filter_by(quizset_id=key, student_id=current_user.id).all() %}
    <h3 hidden><span class = "common">{{ all_marks.append(Grade.query.filter_by(answer_id = str(answers).split(',')[1]).first().mark) }}</span></h3>

    {% endfor %}

    <!--get a list of student ids under current quizset-->
    {% for allAnswers in Answer.query.filter_by(quizset_id=key).all() %}
    {% for students in str(allAnswers).split(',')[0] %}
    <h3 hidden><span class = "common">{{ all_students_id.append(students) }}</span></h3>
    {% endfor %}
    {% endfor %}

    {% if all_marks %}
    <h3>Your mark is : <span class = "common">{{ calcualte_total_mark(all_marks) }}</span></h3>

    <h3>Your ranking is : <span class = "common">{{ calculate_ranking(all_students_id, key, calcualte_total_mark(all_marks)) }} / {{ len(unique_items(all_students_id)) }}</span> </h3>

    {% else %}

    <h1>There is no grade and ranking yet!</h1>

    {% endif %}

    {% endfor %}

</div>


{% endblock %}
{% endblock %}

